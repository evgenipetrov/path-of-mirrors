# Development overrides for docker-compose.yml
#
# Usage: docker compose -f docker-compose.yml -f docker-compose.dev.yml up
#
# This file adds development-friendly volume mounts so that changes to dependencies,
# migrations, and tests sync automatically between host and container.

services:
  backend:
    volumes:
      # Override: mount additional development files
      - ./backend/src:/app/src
      - ./backend/pyproject.toml:/app/pyproject.toml
      - ./backend/uv.lock:/app/uv.lock
      - ./backend/alembic:/app/alembic
      - ./backend/alembic.ini:/app/alembic.ini
      - ./backend/tests:/app/tests
      - ./bin:/app/bin
    environment:
      POB_CLI_POE1: /app/bin/pob-poe1/Path of Building.exe
      POB_CLI_POE2: /app/bin/pob-poe2/Path of Building-PoE2.exe
      POB_LUAJIT: /app/bin/luajit/bin/luajit
      POB_BRIDGE: /app/bin/pob_bridge.lua
      UVICORN_ACCESS_LOG: "0"
    # Development command with hot reload
    command: ["uv", "run", "uvicorn", "src.main:app", "--host", "0.0.0.0", "--port", "8000", "--reload", "--reload-dir", "/app/src"]
